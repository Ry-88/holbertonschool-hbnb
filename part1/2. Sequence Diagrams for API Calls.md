# Sequence Diagrams for API Calls
## User Registration
```mermaid
sequenceDiagram
    participant Client
    participant UserService
    participant ApplicationFacade
    participant User
    participant UserRepository
    participant Database

    Client->>UserService: POST /api/users/register (name, email, password)
    UserService->>ApplicationFacade: registerUser(data)
    ApplicationFacade->>User: create(name, email, password_hash)
    User->>UserRepository: save(user)
    UserRepository->>Database: INSERT User
    Database-->>UserRepository: success
    UserRepository-->>User: user saved
    User-->>ApplicationFacade: user created
    ApplicationFacade-->>UserService: return success (user_id)
    UserService-->>Client: 201 Created + user info
```
Purpose: Allow a new user to sign up.

Flow: The client sends signup data → UserService validates and calls the ApplicationFacade → a User entity is created → persisted via UserRepository → stored in the database → success returned.

Key Contribution of Layers:

Presentation: Accepts API request, forwards to business logic.

Business Logic: Creates user entity, applies rules.

Persistence: Saves user in DB.
##
## Place Creation
```mermaid
sequenceDiagram
    participant Client
    participant PlaceService
    participant ApplicationFacade
    participant Place
    participant PlaceRepository
    participant Database

    Client->>PlaceService: POST /api/places (title, description, ...)
    PlaceService->>ApplicationFacade: createPlace(data, user_id)
    ApplicationFacade->>Place: create(title, description, address, price)
    Place->>PlaceRepository: save(place)
    PlaceRepository->>Database: INSERT Place
    Database-->>PlaceRepository: success
    PlaceRepository-->>Place: place saved
    Place-->>ApplicationFacade: place created
    ApplicationFacade-->>PlaceService: return success (place_id)
    PlaceService-->>Client: 201 Created + place info
```
Purpose: A registered user creates a new listing.

Flow: Client sends place data → PlaceService forwards to ApplicationFacade → a Place entity is created → persisted in PlaceRepository → saved in DB → success returned with place ID.

Layer Roles:

Presentation: Handles API request.

Business Logic: Validates ownership, builds place entity.

Persistence: Saves listing in DB.
##
## Review Submission
```mermaid
sequenceDiagram
    participant Client
    participant ReviewService
    participant ApplicationFacade
    participant Review
    participant ReviewRepository
    participant Database

    Client->>ReviewService: POST /api/reviews (rating, comment, place_id)
    ReviewService->>ApplicationFacade: submitReview(data, user_id)
    ApplicationFacade->>Review: create(rating, comment, user, place)
    Review->>ReviewRepository: save(review)
    ReviewRepository->>Database: INSERT Review
    Database-->>ReviewRepository: success
    ReviewRepository-->>Review: review saved
    Review-->>ApplicationFacade: review created
    ApplicationFacade-->>ReviewService: return success (review_id)
    ReviewService-->>Client: 201 Created + review info
```
Purpose: Users can review places.

Flow: Client submits review → ReviewService → ApplicationFacade creates Review entity linked to User and Place → ReviewRepository saves it → DB insert → success returned.

Layer Roles:

Presentation: Collects input from user.

Business Logic: Applies rules (e.g., rating must be 1–5).

Persistence: Stores review in DB.
##
## Fetching a List of Places
```mermaid
sequenceDiagram
    participant Client
    participant PlaceService
    participant ApplicationFacade
    participant PlaceRepository
    participant Database

    Client->>PlaceService: GET /api/places?city=NYC
    PlaceService->>ApplicationFacade: getPlaces(criteria)
    ApplicationFacade->>PlaceRepository: findByCriteria(criteria)
    PlaceRepository->>Database: SELECT * FROM places WHERE city=NYC
    Database-->>PlaceRepository: result set
    PlaceRepository-->>ApplicationFacade: list of places
    ApplicationFacade-->>PlaceService: return places
    PlaceService-->>Client: 200 OK + places list
```
Purpose: Users query available places by criteria (e.g., city).

Flow: Client requests list → PlaceService → ApplicationFacade → PlaceRepository queries DB → results returned back through layers.

Layer Roles:

Presentation: API endpoint handling.

Business Logic: Delegates query, might apply filters/rules.

Persistence: Executes query against DB and returns results.
